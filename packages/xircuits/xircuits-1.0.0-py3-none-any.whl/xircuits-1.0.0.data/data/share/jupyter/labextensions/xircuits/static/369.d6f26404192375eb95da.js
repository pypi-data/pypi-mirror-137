"use strict";(self.webpackChunkxircuits=self.webpackChunkxircuits||[]).push([[369],{14369:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Xe});var o=n(56271),i=n.n(o),a=n(25112),r=n(56543),s=n(89138),l=n(28800),d=n.n(l);const c=d().div`
		height: 100%;
		background-color: ${e=>e.background};
		background-size: 50px 50px;
		display: flex;

		> * {
			height: 100%;
			min-height: 100%;
			width: 100%;
		}
		background-image: linear-gradient(
				0deg,
				transparent 24%,
				${e=>e.color} 25%,
				${e=>e.color} 26%,
				transparent 27%,
				transparent 74%,
				${e=>e.color} 75%,
				${e=>e.color} 76%,
				transparent 77%,
				transparent
			),
			linear-gradient(
				90deg,
				transparent 24%,
				${e=>e.color} 25%,
				${e=>e.color} 26%,
				transparent 27%,
				transparent 74%,
				${e=>e.color} 75%,
				${e=>e.color} 76%,
				transparent 77%,
				transparent
			);
	`;class u extends o.Component{render(){return o.createElement(c,{background:this.props.background||"rgb(60, 60, 60)",color:this.props.color||"rgba(255,255,255, 0.05)"},this.props.children)}}var g=n(68675),p=n.n(g),m=n(21538);class h extends g.DefaultPortModel{constructor(){super(...arguments),this.canParameterLinkToPort=(e,t)=>{let n=this.getNode().getOptions().extras.type,o=t.getName();if(1==this.isParameterNode(n)){if(console.log("port name: ",o),console.log("parameter port: ",t.getNode().getInPorts()),Object.keys(t.getLinks()).length>0)return t.getNode().getOptions().extras.borderColor="red",t.getNode().getOptions().extras.tip="Port has other link",t.getNode().setSelected(!0),!1;if(!o.startsWith("parameter"))return t.getNode().getOptions().extras.borderColor="red",t.getNode().getOptions().extras.tip="Port linked is not parameter, please link a non parameter node to it",t.getNode().setSelected(!0),!1;for(let e=0;e<t.getNode().getInPorts().length;e++){let n=t.getNode().getInPorts()[e].getOptions().id;if(t.getID()==n)var i=e}let e=/\-([^-]+)\-/,a=t.getNode().getInPorts()[i].getOptions().name.match(e);if(n!=a[1])return t.getNode().getOptions().extras.borderColor="red",t.getNode().getOptions().extras.tip="Port linked not correct data type ("+a[1]+")",t.getNode().setSelected(!0),!1}else{if(o.startsWith("parameter"))return t.getNode().getOptions().extras.borderColor="red",t.getNode().getOptions().extras.tip="Node link to this port must be a hyperparameter/literal",t.getNode().setSelected(!0),!1;if(Object.keys(t.getLinks()).length>0)return t.getNode().getOptions().extras.borderColor="red",t.getNode().getOptions().extras.tip="Port has link, please delete the current link to proceed",t.getNode().setSelected(!0),!1}return t.getNode().getOptions().extras.borderColor="rgb(0,192,255)",delete t.getNode().getOptions().extras.tip,e.getNode().getOptions().extras.borderColor="rgb(0,192,255)",delete e.getNode().getOptions().extras.tip,!0},this.isParameterNode=e=>"boolean"===e||"int"===e||"float"===e||"string"===e||"list"===e||"tuple"===e||"dict"===e,this.canTriangleLinkToTriangle=(e,t)=>{let n=t.getOptions().label,o=this.options.label,i=this.getNode(),a=(t.getNode(),i.getOptions().extras.type);return this.isParameterNode(a)?(t.getNode().getOptions().extras.borderColor="rgb(0,192,255)",delete t.getNode().getOptions().extras.tip,e.getNode().getOptions().extras.borderColor="rgb(0,192,255)",delete e.getNode().getOptions().extras.tip,!0):o.endsWith("▶")||"▶"==n?"▶"===n&&o.endsWith("▶")&&!(Object.keys(e.getLinks()).length>1):(t.getNode().getOptions().extras.borderColor="rgb(0,192,255)",delete t.getNode().getOptions().extras.tip,e.getNode().getOptions().extras.borderColor="rgb(0,192,255)",delete e.getNode().getOptions().extras.tip,!0)},this.getCircularReplacer=()=>{var e=[];return(t,n)=>{if("object"==typeof n&&null!==n){if(e.indexOf(n)>=0)return;e.push(n)}return n}},this.checkLinkDirection=(e,t)=>"right"===e.getOptions().alignment&&"left"===t.getOptions().alignment,this.checkExecutionLoop=(e,t)=>{let n=[],o=e.getParent(),i=t.getParent(),a=o.getOptions().extras.type;for(n.push(o.getID(),i.getID());null!=o&&"Start"!=a&&"boolean"!=a&&"int"!=a&&"float"!=a&&"string"!=a&&"list"!=a&&"tuple"!=a&&"dict"!=a;){let e=o.getInPorts();for(let t=0;t<=e.length;t++)if("▶"===e[t].getOptions().label){let i=e[t].getLinks();if(1!==Object.keys(i).length){Object.keys(i).length>1&&console.log("zombie link detected"),o=null;break}if(o=i[Object.keys(i).toString()].getSourcePort().getParent(),a=o.getOptions().extras.type,n.includes(o.getID()))return console.log("Loop detected at",o.getOptions().name),!1;n.push(o.getID());break}}for(;null!=i&&"Finish"!=i.getOptions().name;){let e=i.getOutPorts();for(let t=0;t<=e.length;t++)if("▶"===e[t].getOptions().label){let o=e[t].getLinks();if(1!==Object.keys(o).length){Object.keys(o).length>1&&console.log("zombie link detected"),i=null;break}if(i=o[Object.keys(o).toString()].getTargetPort().getParent(),n.includes(i.getID()))return console.log("Loop detected at",i.getOptions().name),!1;n.push(i.getID());break}}return!0}}canLinkToPort(e){return e instanceof g.DefaultPortModel&&this.options.in===e.getOptions().in?(e.getNode().getOptions().extras.borderColor="red",e.getNode().getOptions().extras.tip="in not connected to in",e.getNode().setSelected(!0),console.log("in not connected to in"),!1):0==this.canParameterLinkToPort(this,e)?(console.log("Parameter Link To Port failed."),!1):0==this.canTriangleLinkToTriangle(this,e)?(e.getNode().getOptions().extras.borderColor="red",e.getNode().getOptions().extras.tip="Triangle must be linked to triangle",e.getNode().setSelected(!0),console.log("triangle to triangle failed."),!1):0==this.checkLinkDirection(this,e)?(e.getNode().getOptions().extras.borderColor="red",e.getNode().getOptions().extras.tip="Port should be created from outPort [right] to inPort [left]",e.getNode().setSelected(!0),console.log("Port should be created from outPort [right] to inPort [left]"),!1):0!=this.checkExecutionLoop(this,e)&&(e.getNode().getOptions().extras.borderColor="rgb(0,192,255)",delete e.getNode().getOptions().extras.tip,this.getNode().getOptions().extras.borderColor="rgb(0,192,255)",delete this.getNode().getOptions().extras.tip,!0)}}class b extends g.DefaultNodeModel{constructor(e={}){super(Object.assign(Object.assign({},e),{type:"custom-node"})),this.color=e.color||"red",this.name=e.name||"",this.extras=e.extras||{}}serialize(){return Object.assign(Object.assign({},super.serialize()),{color:this.color,name:this.name,extras:this.extras})}deserialize(e){super.deserialize(e),this.color=e.data.color,this.name=e.data.name,this.extras=e.data.extras}addOutPortEnhance(e,t,n=!0,o){const i=new h(o?{in:!1,name:t,label:e,id:o}:{in:!1,name:t,label:e});return n||this.portsOut.splice(0,0,i),this.addPort(i)}addInPortEnhance(e,t,n=!0,o){const i=new h(o?{in:!0,name:t,label:e,id:o}:{in:!0,name:t,label:e});return n||this.portsOut.splice(0,0,i),this.addPort(i)}}var f=n(20439),x=n(41797);class S extends m.ReactWidget{constructor(e){super(),this.handleChange=e=>{this._logConsole.logger&&(this._logConsole.logger.level=e.target.value),this.update()},this.handleKeyDown=e=>{13===e.keyCode&&this._logConsole.activate()},this._id=`level-${x.UUID.uuid4()}`,this.addClass("jp-LogConsole-toolbarLogLevel"),this._logConsole=e,this._logConsole.logger.level="debug",e.source&&this.update(),e.sourceChanged.connect(this._updateSource,this)}_updateSource(e,{oldValue:t,newValue:n}){null!==t&&e.loggerRegistry.getLogger(t).stateChanged.disconnect(this.update,this),null!==n&&e.loggerRegistry.getLogger(n).stateChanged.connect(this.update,this),this.update()}render(){const e=this._logConsole.logger;return i().createElement(i().Fragment,null,i().createElement("label",{htmlFor:this._id,className:null===e?"jp-LogConsole-toolbarLogLevel-disabled":void 0},"Log Level:"),i().createElement(f.HTMLSelect,{id:this._id,className:"jp-LogConsole-toolbarLogLevelDropdown",onChange:this.handleChange,onKeyDown:this.handleKeyDown,value:null==e?void 0:e.level,"aria-label":"Log level",disabled:null===e,options:null===e?[]:["Critical","Error","Warning","Info","Debug"].map((e=>({label:e,value:e.toLowerCase()})))}))}}var v,y=n(12736),w=n(93038);!function(e){e.addCheckpoint="Xircuit-log:add-checkpoint",e.clear="Xircuit-log:clear",e.openLog="Xircuit-log:open",e.setLevel="Xircuit-log:set-level"}(v||(v={}));const E={id:"xircuit-log",autoStart:!0,requires:[m.ICommandPalette,a.ILayoutRestorer,y.IRenderMimeRegistry],activate:(e,t,n,o)=>{console.log("Xircuit-Log is activated!");let i=null,a=null;const r=new m.WidgetTracker({namespace:"Xircuit-log"});n&&n.restore(r,{command:v.openLog,name:()=>"Xircuit-log"}),e.commands.addCommand(v.addCheckpoint,{execute:()=>{var e;return null===(e=null==i?void 0:i.logger)||void 0===e?void 0:e.checkpoint()},icon:f.addIcon,isEnabled:()=>!!i&&null!==i.source,label:"Add Checkpoint"}),e.commands.addCommand(v.clear,{execute:()=>{var e;return null===(e=null==i?void 0:i.logger)||void 0===e?void 0:e.clear()},icon:f.clearIcon,isEnabled:()=>!!i&&null!==i.source,label:"Clear Log"}),e.commands.addCommand(v.setLevel,{execute:e=>{(null==i?void 0:i.logger)&&(i.logger.level=e.level)},isEnabled:()=>!!i&&null!==i.source,label:e=>`Set Log Level to ${e.level}`}),e.commands.addCommand(v.openLog,{label:"Xircuit Log Console",caption:"Xircuit log console",isToggled:()=>null!==a,execute:()=>{a?a.dispose():(i=new w.LogConsolePanel(new w.LoggerRegistry({defaultRendermime:o,maxLength:1e3})),i.source="xircuit",a=new m.MainAreaWidget({content:i}),a.addClass("jp-LogConsole"),a.title.label="Xircuit Log console",a.title.icon=f.listIcon,a.toolbar.addItem("checkpoint",new m.CommandToolbarButton({commands:e.commands,id:v.addCheckpoint})),a.toolbar.addItem("clear",new m.CommandToolbarButton({commands:e.commands,id:v.clear})),a.toolbar.addItem("level",new S(a.content)),a.disposed.connect((()=>{a=null,i=null,e.commands.notifyCommandChanged()})),e.shell.add(a,"main",{mode:"split-bottom"}),r.add(a),a.update(),e.commands.notifyCommandChanged())}}),t.addItem({command:v.openLog,category:"Examples"}),e.commands.addCommand("jlab-examples/custom-log-console:logHTMLMessage",{label:"HTML log message",caption:"Custom HTML log message example.",execute:()=>{var e;null===(e=null==i?void 0:i.logger)||void 0===e||e.log({type:"html",level:"debug",data:"<div>Hello world HTML!!</div>"})}}),e.commands.addCommand("jlab-examples/custom-log-console:logTextMessage",{label:"Text log message",caption:"Custom text log message example.",execute:()=>{var e;null===(e=null==i?void 0:i.logger)||void 0===e||e.log({type:"text",level:"info",data:"Hello world text!!"})}}),e.commands.addCommand(H.outputMsg,{label:"Output log message",caption:"Output xircuit log message.",execute:e=>{var t;const n=void 0===e.outputMsg?"":e.outputMsg,o={type:"output",level:e.level,data:{output_type:"display_data",data:{"text/plain":n}}};null===(t=null==i?void 0:i.logger)||void 0===t||t.log(o)}})}};class O{constructor(e){this.app=e}debug(e,...t){this.emitLogMessage("debug",e,t)}info(e,...t){this.emitLogMessage("info",e,t)}warn(e,...t){this.emitLogMessage("warning",e,t)}error(e,...t){this.emitLogMessage("error",e,t)}critical(e,...t){this.emitLogMessage("critical",e,t)}emitLogMessage(e,t,n){if(n.length>0){const o=t+n;this.app.commands.execute(H.outputMsg,{outputMsg:o,level:e})}else this.app.commands.execute(H.outputMsg,{outputMsg:t,level:e})}}var k=n(7447),C=n(34374);async function _(e="",t={}){const n=C.ServerConnection.makeSettings(),o=k.URLExt.join(n.baseUrl,"xircuits",e);let i;try{i=await C.ServerConnection.makeRequest(o,t,n)}catch(e){throw new C.ServerConnection.NetworkError(e)}const a=await i.json();if(!i.ok)throw new C.ServerConnection.ResponseError(i,a.message);return a}async function N(e){return await async function(){return await _("components/")}()}var P=n(13211),D=n(23706);const I=e=>{const t=m.ReactWidget.create(e);return P.MessageLoop.sendMessage(t,D.Widget.Msg.UpdateRequest),t.getValue=()=>{var e;const n=t.node.querySelector("form"),o={};for(const t of Object.values(null!==(e=null==n?void 0:n.elements)&&void 0!==e?e:[]))"checkbox"===t.type?o[t.name]=t.checked:o[t.name]=t.value;return o},t},L=(e,t)=>{e.value.trim()?t.add(e):t.delete(e)},X=(e,t,n)=>{e.size===t.length?(e=>{e.removeAttribute("disabled")})(n):(e=>{e.setAttribute("disabled","disabled")})(n)};var T=n(96637),M=n(76442),W=n.n(M),A=n(69519),F=n.n(A);const R=({childSparkSubmitNodes:e,childStringNodes:t,childBoolNodes:n,childIntNodes:a,childFloatNodes:r})=>{const[s,l]=(0,o.useState)([!1]);return i().createElement("form",null,i().createElement("h3",{style:{marginTop:0,marginBottom:5}},"Hyperparameter:"),i().createElement("div",null,0!=e.length?i().createElement(i().Fragment,null,i().createElement("div",null,i().createElement("h4",{style:{marginTop:2,marginBottom:0}},"Spark Submit")),i().createElement("div",null,e,i().createElement("div",null,i().createElement(W(),{minRows:3,maxRows:8,name:e,style:{width:205,fontSize:12},autoFocus:!0})))):null),i().createElement("div",null),i().createElement("div",null,i().createElement("h4",{style:{marginTop:2,marginBottom:0}},"String")),t.map(((e,t)=>i().createElement("div",{key:`index-${t}`},e,i().createElement("div",null,i().createElement("input",{type:"text",name:e}))))),i().createElement("div",null,0!=n.length?i().createElement(i().Fragment,null,i().createElement("br",null),i().createElement("h4",{style:{marginTop:2,marginBottom:0}},"Boolean")):null),n.map(((e,t)=>i().createElement("div",{key:`index-${t}`},e,i().createElement("div",null,i().createElement(F(),{checked:s[t]||!1,name:e,onChange:e=>((e,t)=>{let n=[...s];n[t]=e,l(n),console.log("Boolean change: ",s)})(e,t),handleDiameter:25,height:20,width:48}))))),i().createElement("div",null,0!=a.length?i().createElement(i().Fragment,null,i().createElement("br",null),i().createElement("h4",{style:{marginTop:2,marginBottom:0}},"Integer")):null),a.map(((e,t)=>i().createElement("div",{key:`index-${t}`},e,i().createElement("div",null,i().createElement(T,{className:"form-control",name:e,value:"0",min:0,step:1,precision:0,mobile:!0,style:{wrap:{boxShadow:"0 0 1px 1px #fff inset, 1px 1px 5px -1px #000",padding:"2px 2.26ex 2px 2px",borderRadius:"6px 3px 3px 6px",fontSize:20,width:"10vw"},input:{borderRadius:"6px 3px 3px 6px",padding:"0.1ex 1ex",border:"#ccc",marginRight:4,display:"block",fontWeight:100,width:"11.3vw"},plus:{background:"rgba(255, 255, 255, 100)"},minus:{background:"rgba(255, 255, 255, 100)"},btnDown:{background:"rgba(0, 0, 0)"},btnUp:{background:"rgba(0, 0, 0)"}}}))))),i().createElement("div",null,0!=r.length?i().createElement(i().Fragment,null,i().createElement("br",null),i().createElement("h4",{style:{marginTop:2,marginBottom:0}},"Float")):null),r.map(((e,t)=>i().createElement("div",{className:"p-col-12",key:`index-${t}`},e,i().createElement("div",null,i().createElement(T,{className:"form-control",name:e,value:"0.00",min:0,step:.1,precision:2,mobile:!0,style:{wrap:{boxShadow:"0 0 1px 1px #fff inset, 1px 1px 5px -1px #000",padding:"2px 2.26ex 2px 2px",borderRadius:"6px 3px 3px 6px",fontSize:20,width:"10vw"},input:{borderRadius:"6px 3px 3px 6px",padding:"0.1ex 1ex",border:"#ccc",marginRight:4,display:"block",fontWeight:100,width:"11.3vw"},plus:{background:"rgba(255, 255, 255, 100)"},minus:{background:"rgba(255, 255, 255, 100)"},btnDown:{background:"rgba(0, 0, 0)"},btnUp:{background:"rgba(0, 0, 0)"}}}))))))};n(25872);const j=d().div`
		flex-grow: 1;
		display: flex;
		flex-direction: column;
		min-height: 100%;
		height: 800px;
	`,B=(d().div`
		display: flex;
		background: rgb(30, 30, 30);
		flex-grow: 0;
		flex-shrink: 0;
		color: white;
		font-family: Helvetica, Arial, sans-serif;
		padding: 10px;
		align-items: center;
	`,d().div`
		display: flex;
		flex-grow: 1;
	`),$=d().div`
		position: relative;
		flex-grow: 1;
	`,H={openXircuitEditor:"Xircuit-editor:open",openDocManager:"docmanager:open",newDocManager:"docmanager:new-untitled",saveDocManager:"docmanager:save",reloadDocManager:"docmanager:reload",revertDocManager:"docmanager:restore-checkpoint",createNewXircuit:"Xircuit-editor:create-new",saveXircuit:"Xircuit-editor:save-node",compileXircuit:"Xircuit-editor:compile-node",runXircuit:"Xircuit-editor:run-node",debugXircuit:"Xircuit-editor:debug-node",lockXircuit:"Xircuit-editor:lock-node",createArbitraryFile:"Xircuit-editor:create-arbitrary-file",openDebugger:"Xircuit-debugger:open",breakpointXircuit:"Xircuit-editor:breakpoint-node",nextNode:"Xircuit-editor:next-node",testXircuit:"Xircuit-editor:test-node",outputMsg:"Xircuit-log:logOutputMessage",executeToOutputPanel:"Xircuit-output-panel:execute"},z=({context:e,xircuitsApp:t,app:n,shell:a,commands:r,widgetId:l,serviceManager:d,saveXircuitSignal:c,compileXircuitSignal:p,runXircuitSignal:h,runTypeXircuitSignal:f,debugXircuitSignal:x,lockNodeSignal:S,breakpointXircuitSignal:v,currentNodeSignal:y,testXircuitSignal:w,continueDebugSignal:E,nextNodeDebugSignal:k,stepOverDebugSignal:C,terminateDebugSignal:P,stepInDebugSignal:T,stepOutDebugSignal:M,evaluateDebugSignal:W,debugModeSignal:A})=>{const[F,z]=(0,o.useState)(0),U=(0,o.useCallback)((()=>z((e=>e+1))),[]),[J,V]=(0,o.useState)(!1),[q,G]=(0,o.useState)(!1),[Q,K]=(0,o.useState)(!0),[Y,Z]=(0,o.useState)([]),[ee,te]=(0,o.useState)(!1),[ne,oe]=(0,o.useState)(!1),[ie,ae]=(0,o.useState)(!1),[re,se]=(0,o.useState)(""),[le,de]=(0,o.useState)(["experiment name"]),[ce,ue]=(0,o.useState)([]),[ge,pe]=(0,o.useState)([]),[me,he]=(0,o.useState)([]),[be,fe]=(0,o.useState)([""]),[xe,Se]=(0,o.useState)([0]),[ve,ye]=(0,o.useState)([0]),[we,Ee]=(0,o.useState)([!1]),[Oe,ke]=(0,o.useState)([]),[Ce,_e]=(0,o.useState)(!1),[Ne,Pe]=(0,o.useState)(!1),[De,Ie]=(0,o.useState)(!1),[Le,Xe]=(0,o.useState)(!1),[Te,Me]=(0,o.useState)(!1),[We,Ae]=(0,o.useState)(-1),[Fe,Re]=(0,o.useState)("run"),je=new O(n),Be=(0,o.useRef)(e),$e=(0,o.useCallback)((()=>{if(Be.current.isReady){let e=t.getDiagramEngine().getModel().serialize();Be.current.model.fromString(JSON.stringify(e,null,4)),V(!1)}}),[]);(0,o.useEffect)((()=>{const n=Be.current,o=()=>{const o=n.model.toJSON();if(e.isReady){let e=((e,t)=>{let n=new g.DiagramModel,o=e.layers[0].models,i=e.layers[1].models,a=e.offsetX,r=e.offsetY,s=e.zoom;for(let e in i){let o=i[e],a=new b({id:o.id,type:o.type,name:o.name,locked:o.locked,color:o.color,extras:o.extras});a.setPosition(o.x,o.y);for(let e in o.ports){let t=o.ports[e];"right"==t.alignment&&a.addOutPortEnhance(t.label,t.name,!0,t.id),"left"==t.alignment&&a.addInPortEnhance(t.label,t.name,!0,t.id)}n.addAll(a),t.setModel(n)}for(let e in o){let i=o[e];if(i.sourcePort&&i.targetPort){let e=new g.DefaultLinkModel,o=n.getNode(i.source).getPortFromID(i.sourcePort);e.setSourcePort(o);let a=n.getNode(i.target).getPortFromID(i.targetPort);e.setTargetPort(a),n.addAll(e),t.setModel(n)}}return n.registerListener({nodesUpdated:()=>{const e=setTimeout((()=>{$e(),K(!1)}),10);return()=>clearTimeout(e)},linksUpdated:function(e){e.link.registerListener({sourcePortChanged:e=>{$e()},targetPortChanged:e=>{$e()},entityRemoved:e=>{$e()}})}}),n.setOffsetX(a),n.setOffsetY(r),n.setZoomLevel(s),n})(o,t.getDiagramEngine());t.getDiagramEngine().setModel(e)}};return n.ready.then(o),n.model.contentChanged.connect(o),()=>{n.model.contentChanged.disconnect(o)}}),[]);const He=(e,t)=>{for(let n=0;n<e.length;n++)if(e[n].getID()===t)return n;return null},ze=(e,t)=>{for(let n=0;n<e.length;n++){let o=e[n];if(o.getSourcePort().getNode().getID()===t&&"▶"==o.getTargetPort().getOptions().label)return o.getTargetPort().getNode().getID()}return null},Ue=(e,t)=>{for(let n=0;n<e.length;n++){let o=e[n];if(o.getOptions().name===t)return o}return null},Je=(e,t)=>{for(let n=0;n<e.length;n++){let o=e[n];if(o.getID()===t)return o}return null},Ve=()=>{let e=t.getDiagramEngine().getModel(),n=e.getNodes(),o=Ue(n,"Start");if(null==o&&(o=Ue(n,"🔴Start")),o){let t=o.getID(),i=[];for(i.push(o);null!=ze(e.getLinks(),t);){let o=ze(e.getLinks(),t);if(o){let e=Je(n,o);e&&(t=e.getID(),i.push(e))}}return i}return null},qe=()=>{let e=new Map(Oe.map((e=>[e.task,e]))),n=Oe.map((e=>e.task)),o=t.getDiagramEngine().getModel(),i=o.getNodes(),a=Ue(i,"Start"),r="from argparse import ArgumentParser\n";r+="from datetime import datetime\n",r+="from time import sleep\n",r+="import json, os, signal\n",r+="from flask import Flask, jsonify, request\n",r+="from threading import Thread\n";let s={},l=Ve();for(let e in l){let t=l[e].extras.type,n=l[e].name;n=n.replace(/\s+/g,""),"Start"==t||"Finish"==t||"boolean"===t||"int"===t||"float"===t||"string"===t||(s[n]=n)}let d=new Set;for(let t in s){let n=e.get(t)||{python_path:null};null!=n.python_path&&d.add(n.python_path)}d.size>0&&(r+="import sys\n"),d.forEach((e=>{r+=`sys.path.append("${e.replace(/\\/gi,"\\\\")}")\n`}));for(let e in s){let t,o=n.indexOf(e),i="components";-1!=o&&(t=Oe[o],i=t.package_name),r+="from "+i+" import "+e+"\n"}r+="\napp = Flask(__name__)\n",r+="input_data = []\n",r+="continue_input_data = []\n",r+="inarg_output_data = []\n",r+="outarg_output_data = []\n",r+="is_done_list = []\n",r+="\ndef main(args):\n";for(let e=0;e<l.length;e++){let t=l[e].extras.type;if("Start"==t||"Finish"==t||"boolean"===t||"int"===t||"float"===t||"string"===t);else{let t="c_"+e,n=l[e].name;n=n.replace(/\s+/g,""),r+="    "+t+" = "+n+"()\n"}}if(r+="\n",a){let e=a.getID(),t=0;for(;null!=ze(o.getLinks(),e);){let n=ze(o.getLinks(),e);if(n){let o="c_"+ ++t,a=Je(i,n),s=a.getPorts();for(let e in s)if("left"==s[e].getOptions().alignment){let t=s[e].getOptions().label;if(t=t.replace(/\s+/g,"_"),t=t.toLowerCase(),t.startsWith("★")){const e=t.split("★")[1];t=e}if("▶"==t);else{let n=s[e].getLinks();for(let i in n){let a=n[i].getSourcePort().getNode().name,d=n[i].getSourcePort().getNode().getOptions().extras.type,c=n[i].getSourcePort().getNode().getOptions().id,u=n[i].getSourcePort().getOptions().label,g="c_"+He(l,c),p=s[e].links[i].sourcePort.parent.options.id;if(e.startsWith("parameter"))if(a.startsWith("Literal"))r+="string"==d?"    "+o+"."+t+".value = '"+u+"'\n":"list"==d?"    "+o+"."+t+".value = ["+u+"]\n":"tuple"==d?"    "+o+"."+t+".value = ("+u+")\n":"dict"==d?"    "+o+"."+t+".value = {"+u+"}\n":"    "+o+"."+t+".value = "+u+"\n";else if(p!=c||a.startsWith("Hyperparameter")){u=u.replace(/\s+/g,"_"),u=u.toLowerCase(),a=a.split(": ");let e=a[a.length-1];e=e.replace(/\s+/g,"_"),e=e.toLowerCase(),r+="    "+o+"."+t+".value = args."+e+"\n"}else r+="    "+o+"."+t+" = "+g+"."+u+"\n";else r+="    "+o+"."+t+" = "+g+"."+u+"\n"}}}a&&(e=a.getID())}}}r+="\n";for(let e=0;e<l.length;e++){let t=l[e].extras.type,n="c_"+e,o="c_"+(e+1);"Start"==t||"Finish"==t||(e==l.length-2?r+="    "+n+".next = None\n":r+="    "+n+".next = "+o+"\n")}if(r+="    debug_mode = args.debug_mode\n",l.length>2){if(r+="\n",r+="    next_component = c_1\n",r+="    while next_component:\n",r+="        if debug_mode:\n",r+="            if len(continue_input_data) > 0 and continue_input_data[-1] == 'continue':\n",r+="                vars_dict = vars(next_component)\n",r+="                new_dict = {}\n",r+="                for i in vars_dict:\n",r+="                    if not i in ['next', 'done']:\n",r+="                        new_dict[i] = next_component.__getattribute__(i).value\n",r+="                        if 'InArg' in str(vars_dict[i]):\n",r+="                            inarg_output_data.append(str(i) + ': ' + str(next_component.__getattribute__(i).value))\n",r+="                        if 'OutArg' in str(vars_dict[i]):\n",r+="                            outarg_output_data.append(str(i) + ': ' + str(next_component.__getattribute__(i).value))\n",r+="                continue_input_data.clear()\n",r+="\n",r+="            if len(input_data) > 0 and input_data[-1] == 'run':\n",r+="                is_done, next_component = next_component.do()\n",r+="                input_data.clear()\n",r+="                is_done_list.append(is_done)\n",r+="\n",r+="            if len(input_data) > 0 and input_data[-1] == 'skip':\n",r+="                is_done, next_component = next_component.do()\n",r+="\n",r+="        else:\n",r+="            is_done, next_component = next_component.do()\n",r+="\n",r+="@app.route('/terminate')\n",r+="def shutdown():\n",r+="    os.kill(os.getpid(), signal.SIGINT)\n",r+='    return jsonify({ "success": True, "message": "Server is shutting down..." })\n\n',r+="@app.route('/run')\n",r+="def next_node(input_data=input_data):\n",r+='    input_data.append("run")\n',r+='    return jsonify({ "success": True, "message": "Run is executed" })\n\n',r+="@app.route('/execute')\n",r+="def get_execution_output():\n",r+="    return str(is_done_list)\n\n",r+="@app.route('/clear_execution')\n",r+="def clear_execution_output():\n",r+="    is_done_list.clear()\n",r+='    return jsonify({ "success": True, "message": "Clearing execution" })\n\n',r+="@app.route('/continue')\n",r+="def continue_node(continue_input_data=continue_input_data):\n",r+='    continue_input_data.append("continue")\n',r+='    return jsonify({ "success": True, "message": "Continue is executed" })\n\n',r+="@app.route('/clear')\n",r+="def clear_node():\n",r+="    inarg_output_data.clear()\n",r+="    outarg_output_data.clear()\n",r+='    return jsonify({ "success": True, "message": "Clearing input/output args" })\n\n',r+="@app.route('/get/output')\n",r+="def get_output_data():\n",r+="    inarg_output = ''\n",r+="    if inarg_output_data != []:\n",r+="        inarg_output = 'InArg -> '\n",r+="        inarg_output += '\t'.join(inarg_output_data)\n\n",r+="    outarg_output = ''\n",r+="    if outarg_output_data != []:\n",r+="        outarg_output = 'OutArg -> '\n",r+="        outarg_output += '\t'.join(outarg_output_data)\n\n",r+="    return (str(inarg_output) + ' ' + str(outarg_output)).strip()\n\n",r+="if __name__ == '__main__':\n",r+="    parser = ArgumentParser()\n",le)for(let e=0;e<le.length;e++){let t=le[e].replace(/\s+/g,"_");t=t.toLowerCase(),r+="experiment_name"==t?"    parser.add_argument('--"+t+"', default=datetime.now().strftime('%Y-%m-%d %H:%M:%S'), type=str)\n":"    parser.add_argument('--"+t+"', default='test', type=str)\n"}if(ce)for(let e=0;e<ce.length;e++){let t=ce[e].replace(/\s+/g,"_");t=t.toLowerCase(),r+="    parser.add_argument('--"+t+"', default='1', type=int)\n"}if(ge)for(let e=0;e<ge.length;e++){let t=ge[e].replace(/\s+/g,"_");t=t.toLowerCase(),r+="    parser.add_argument('--"+t+"', default='1.0', type=float)\n"}if(me)for(let e=0;e<me.length;e++){let t=me[e].replace(/\s+/g,"_");t=t.toLowerCase(),r+="    parser.add_argument('--"+t+"', default=True, type=bool)\n"}r+="    parser.add_argument('--debug_mode', default=False, type=bool)\n\n",r+="    debug_mode = parser.parse_args().debug_mode\n",r+="    if debug_mode:\n",r+="        thread = Thread(target=app.run, daemon=True)\n",r+="        thread.start()\n\n",r+="    main(parser.parse_args())"}return r},Ge=()=>{let e=t.getDiagramEngine().getModel().getNodes();for(let t=0;t<e.length;t++){let n=e[t].portsIn,o=0;if(0!=n){if("▶"==n[o].getOptions().label&&0!=Object.keys(n[0].getLinks()).length)continue;return e[t].getOptions().extras.borderColor="red",e[t].getOptions().extras.tip="Please make sure this node ▶ is properly connected ",e[t].setSelected(!0),!1}}return!0},Qe=()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&($e(),K(!0),V(!0),r.execute(H.saveDocManager))},Ke=async t=>{if(Be.current.model.dirty){const e=await(0,m.showDialog)({title:"This xircuits contains unsaved changes.",body:"To run the xircuits the changes need to be saved.",buttons:[m.Dialog.cancelButton(),m.Dialog.okButton({label:"Save and Run"})]});if(!e.button||!0!==e.button.accept)return;await Qe()}let n=Ge(),o=(()=>{let e=Ve();for(let t=0;t<e.length;t++)for(let n=0;n<e[t].portsIn.length;n++){let o=e[t].portsIn[n];if(o.getOptions().label.startsWith("★")&&0==Object.keys(o.getLinks()).length)return e[t].getOptions().extras.borderColor="red",e[t].getOptions().extras.tip="Please make sure the [★]COMPULSORY InPorts are connected ",e[t].setSelected(!0),!1}return!0})();if(!n)return Le?void alert("Please connect all the nodes before debugging."):void alert("Please connect all the nodes before running.");if(!o)return void alert("Please connect all [★]COMPULSORY InPorts.");let i=qe();if("run-dont-compile"!=Fe&&(r.execute(H.createArbitraryFile,{pythonCode:i,showOutput:!1}),G(!0)),t){const e=await ot(),t="--debug_mode True";if(e){r.execute(H.executeToOutputPanel,{runCommand:e,debug_mode:t}),r.execute(H.openDebugger),Xe(!0),Me(!1);let n=Ve();n.forEach((e=>{e.setSelected(!1)})),Ae(0),n[0].setSelected(!0)}}else e.ready.then((async()=>{let e=await ot(),t=e.commandStr,n=e.addArgs;e&&r.execute(H.executeToOutputPanel,{runCommand:t,runType:Fe,addArgsSparkSubmit:n})}))};function Ye(e){return new Promise((t=>setTimeout(t,e)))}const Ze=async()=>(await et("clear"),await et("continue"),await et("get/output"));async function et(e){const t={command:e};try{return await _("debug/enable",{body:JSON.stringify(t),method:"POST"})}catch(e){console.error(`Error on POST /xircuit/debug/enable ${t}.\n${e}`)}}const tt=async()=>{if(!Le)return void alert("Not in debug mode");let e,t,n=Ve(),o=We;if(t=n[o],e=n[o],t.getOptions().name.startsWith("🔴")){if(e.setSelected(!0),e.getOptions().color="rgb(150,150,150)",t=n[o+1],t.getOptions().name.startsWith("🔴")){if("🔴Start"!=t.getOptions().name&&"Start"!=t.getOptions().name){await et("run");let e=await et("get_run"),n=void 0===e.output?"":e.output;for(;n.split(",").length!=o;)await Ye(1500),e=await et("get_run"),n=void 0===e.output?"":e.output;await Ze(),await Ye(1e3);let i=await et("get/output"),a=t;y.emit({item:a,item2:i})}await Ye(1e3),e.setSelected(!1),t.setSelected(!0),"Finish"!=t.getOptions().name&&"🔴Finish"!=t.getOptions().name&&(o+=1,t=n[o],Ae(o))}await Ye(1e3),e.setSelected(!1)}for(;!t.getOptions().name.startsWith("🔴");){if(e=t,e.setSelected(!0),e.getOptions().color="rgb(150,150,150)","Start"!=t.getOptions().name&&"🔴Start"!=t.getOptions().name){await Ye(1e3),e.setSelected(!1),t.setSelected(!0),await et("run");let n=await et("get_run"),i=void 0===n.output?"":n.output;for(;i.split(",").length!=o;)await Ye(1500),n=await et("get_run"),i=void 0===n.output?"":n.output}if(await Ye(1e3),e.setSelected(!1),e=t,o+=1,t=n[o],t.setSelected(!0),Me(!0),"Finish"==t.getOptions().name||"🔴Finish"==t.getOptions().name)return e.setSelected(!1),t.setSelected(!0),t.getOptions().color="rgb(150,150,150)",await Ye(1e3),t.setSelected(!1),alert("Finish Execution."),Ae(-1),Xe(!1),Me(!1),void n.forEach((e=>{e.setSelected(!0),e.getOptions().color=e.color}));Ae(o),await Ze(),await Ye(1e3);let i=await et("get/output"),a=t;y.emit({item:a,item2:i})}"Finish"!=t.getOptions().name&&"🔴Finish"!=t.getOptions().name||(await Ye(1e3),e.setSelected(!1),t.setSelected(!0),t.getOptions().color="rgb(150,150,150)",Ae(-1),Xe(!1),Me(!1),alert("Finish Execution."),n.forEach((e=>{e.setSelected(!0),e.getOptions().color=e.color})))},nt=e=>{let t=Ve();if(e)return t.forEach((e=>{e.setSelected(!0),e.getOptions().color=e.color,e.setSelected(!1)})),void t[0].setSelected(!0);t.forEach((e=>{e.setSelected(!0),e.getOptions().color=e.color}))};(0,o.useEffect)((()=>{se("spark-submit"==Fe?"Added Arguments":""),e.ready.then((()=>{if(Q){let e=t.getDiagramEngine().getModel().getNodes(),n=e.length;for(let t=0;t<n;t++){let n=e[t].getOptions().name;if(n.startsWith("Hyperparameter")){let e=/\(([^)]+)\)/,t=n.match(e),o=n.split(": ");"String"==t[1]?de((e=>[...e,o[o.length-1]].sort())):"Int"==t[1]?ue((e=>[...e,o[o.length-1]].sort())):"Float"==t[1]?pe((e=>[...e,o[o.length-1]].sort())):"Boolean"==t[1]&&he((e=>[...e,o[o.length-1]].sort()))}}}else de(["experiment name"]),ue([]),pe([]),he([])}))}),[Q,Fe]);const ot=async()=>{var e;const t={title:"Run",body:I(i().createElement(R,{childSparkSubmitNodes:re,childStringNodes:le,childBoolNodes:me,childIntNodes:ce,childFloatNodes:ge})),buttons:[m.Dialog.cancelButton(),m.Dialog.okButton({label:"Start"})],defaultButton:1,focusNodeSelector:"#name"},n=await(async(e,t)=>{var n,o,i,a;const r=e.body,s=new m.Dialog(e);if(r instanceof D.Widget){const t=r.node.querySelectorAll("[data-form-required]");if(t&&t.length>0){const r=new Set,l=s.handleEvent;s.handleEvent=e=>{e instanceof KeyboardEvent&&"keydown"===e.type&&13===e.keyCode&&r.size!==t.length?(e.stopPropagation(),e.preventDefault()):l.call(s,e)};const d=null!==(n=e.defaultButton)&&void 0!==n?n:(null!==(i=null===(o=e.buttons)||void 0===o?void 0:o.length)&&void 0!==i?i:0)-1,c=null===(a=s.node.querySelector(".jp-Dialog-footer"))||void 0===a?void 0:a.getElementsByTagName("button")[d];t.forEach((e=>{L(e,r);const n=e.tagName.toLowerCase();"select"===n?e.addEventListener("change",(e=>{L(e.target,r),X(r,t,c)})):"input"!==n&&"textarea"!==n||e.addEventListener("keyup",(e=>{L(e.target,r),X(r,t,c)}))})),X(r,t,c)}}return s.launch()})(t);if("Cancel"==n.button.label)return!1;let o=" ",a=null!==(e=n.value[re])&&void 0!==e?e:"";return le.forEach((e=>{if("experiment name"==e){var t=new Date;let n=`${t.getFullYear().toString().padStart(4,"0")}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")} ${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}:${t.getSeconds().toString().padStart(2,"0")}`;je.info(e+": "+n)}else if(n.value[e]){je.info(e+": "+n.value[e]);let t=e.replace(/\s+/g,"_");t=t.toLowerCase(),o+="--"+t+" "+n.value[e]+" "}})),me&&me.forEach((e=>{if(je.info(e+": "+n.value[e]),n.value[e]){let t=e.replace(/\s+/g,"_");t=t.toLowerCase(),o+="--"+t+" "+n.value[e]+" "}})),ce&&ce.forEach((e=>{if(je.info(e+": "+n.value[e]),n.value[e]){let t=e.replace(/\s+/g,"_");t=t.toLowerCase(),o+="--"+t+" "+n.value[e]+" "}})),ge&&ge.forEach((e=>{if(je.info(e+": "+n.value[e]),n.value[e]){let t=e.replace(/\s+/g,"_");t=t.toLowerCase(),o+="--"+t+" "+n.value[e]+" "}})),{commandStr:o,addArgs:a}};[[c,Qe],[p,()=>{var e;if((null===(e=a.currentWidget)||void 0===e?void 0:e.id)!==l)return;let t=Ge();if(!J)return void alert("Please save before compiling.");if(!t)return void alert("Please connect all the nodes before compiling.");let n=qe();G(!0),r.execute(H.createArbitraryFile,{pythonCode:n,showOutput:!0})}],[h,async()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&Ke(!1)}],[x,async()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&(nt(!0),Ke(!0))}],[S,()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&Ve().forEach((e=>{const t=e.getOptions().name;e.isLocked()||"Start"!==t&&"Finish"!==t&&(e.setSelected(!0),e.setLocked(!0))}))}],[v,()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&t.getDiagramEngine().getModel().getNodes().forEach((e=>{if(1==e.getOptions().selected){let t=e.getOptions().name;t.startsWith("🔴")?e.getOptions().name=t.split("🔴")[1]:e.getOptions().name="🔴"+t,e.setSelected(!0),e.setSelected(!1)}}))}],[w,()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&alert("Testing")}],[E,async()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&(0==We&&nt(!0),await tt())}],[k,async()=>{var e;if((null===(e=a.currentWidget)||void 0===e?void 0:e.id)!==l)return;if(!Le)return void alert("Not in debug mode");let t,n,o=Ve(),i=We;if(t=o[i],n=o[i],"Start"==t.getOptions().name||"🔴Start"==t.getOptions().name){t.setSelected(!0),await Ze(),t.getOptions().color="rgb(150,150,150)",t.setSelected(!1),i+=1,t=o[i],t.setSelected(!0),n.setSelected(!1),Ae(i),await Ye(1500);let e=await et("get/output");await Ye(1e3);let a=t;y.emit({item:a,item2:e})}else{await et("run");let e=await et("get_run"),a=void 0===e.output?"":e.output;for(;a.split(",").length!=i;)await Ye(1500),e=await et("get_run"),a=void 0===e.output?"":e.output;await Ze(),n.setSelected(!0),i+=1,t=o[i],t.setSelected(!0),n.getOptions().color="rgb(150,150,150)",n.setSelected(!1),Ae(i),await Ye(1500);let r=await et("get/output"),s=t;y.emit({item:s,item2:r})}"Finish"==t.getOptions().name&&(t.getOptions().color="rgb(150,150,150)",t.setSelected(!1),t.setSelected(!0),Ae(-1),Xe(!1),Me(!1),o.forEach((e=>{e.getOptions().color="rgb(150,150,150)",e.setSelected(!1),e.setSelected(!0),e.getOptions().color=e.color})),alert("Finish Execution."))}],[C,async()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&(0==We&&nt(!0),await tt())}],[P,()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&Le&&(nt(!1),(async()=>{await et("terminate")})(),Ae(-1),Xe(!1),Me(!1),alert("Execution has been terminated."))}],[T,()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&alert("Step In")}],[M,()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&alert("Step Out")}],[W,()=>{var e;(null===(e=a.currentWidget)||void 0===e?void 0:e.id)===l&&alert("Evaluate Code")}]].forEach((([e,t])=>{(0,o.useEffect)((()=>(e.connect(t),()=>{e.disconnect(t)})),[e,t])}));const it=async()=>{const e=await N();e.length>0&&ke([]),ke(e)};return(0,o.useEffect)((()=>{let e;f.connect(((t,n)=>{e=n.runType,Re(e)}))}),[f]),(0,o.useEffect)((()=>{A.emit({debugMode:Le,inDebugMode:Te})}),[Le,Te]),(0,o.useEffect)((()=>{Ce||it()}),[]),(0,o.useEffect)((()=>{const e=setInterval((()=>{it()}),5e3);return()=>clearInterval(e)}),[Oe]),i().createElement(j,null,i().createElement(B,null,i().createElement($,{onDrop:e=>{var n=JSON.parse(e.dataTransfer.getData("storm-diagram-node"));let o,i=Oe.map((e=>e.task)).indexOf(n.name),a=null;if(-1!=i&&(o=Oe[i]),null!=o)if("GENERAL"==o.header)if("math"===n.type)a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addInPortEnhance("▶","in-0"),a.addInPortEnhance("A","in-1"),a.addInPortEnhance("B","in-2"),a.addOutPortEnhance("▶","out-0"),a.addOutPortEnhance("value","out-1");else if("convert"===n.type)a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addInPortEnhance("▶","in-0"),a.addInPortEnhance("model","parameter-string-in-1"),a.addOutPortEnhance("▶","out-0"),a.addOutPortEnhance("converted","out-1");else if("string"===n.type)if(n.name.startsWith("Literal")){let e=window.prompt("Enter String Value (Without Quotes):");a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance(e,"out-0")}else{let e=window.prompt("notice","Enter String Name (Without Quotes):");a=new b({name:"Hyperparameter (String): "+e,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance("▶","parameter-out-0")}else if("int"===n.type)if(n.name.startsWith("Literal")){let e=window.prompt("Enter Int Value (Without Quotes):");a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance(e,"out-0")}else{let e=window.prompt("notice","Enter Int Name (Without Quotes):");a=new b({name:"Hyperparameter (Int): "+e,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance("▶","parameter-out-0")}else if("float"===n.type)if(n.name.startsWith("Literal")){let e=window.prompt("Enter Float Value (Without Quotes):");a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance(e,"out-0")}else{let e=window.prompt("notice","Enter Float Name (Without Quotes):");a=new b({name:"Hyperparameter (Float): "+e,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance("▶","parameter-out-0")}else if("boolean"===n.type)if(n.name.startsWith("Literal")){let e=n.name.split(" ");e=e[e.length-1],a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance(e,"out-0")}else{let e=window.prompt("notice","Enter Boolean Name (Without Quotes):");a=new b({name:"Hyperparameter (Boolean): "+e,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance("▶","parameter-out-0")}else if("list"===n.type)if(n.name.startsWith("Literal")){let e=window.prompt("Enter List Values (Without [] Brackets):");a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance(e,"out-0")}else{let e=window.prompt("notice","Enter List Name (Without Quotes):");a=new b({name:"Hyperparameter (List): "+e,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance("▶","parameter-out-0")}else if("tuple"===n.type)if(n.name.startsWith("Literal")){let e=window.prompt("Enter Tuple Values (Without () Brackets):");a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance(e,"out-0")}else{let e=window.prompt("notice","Enter Tuple Name (Without Quotes):");a=new b({name:"Hyperparameter (Tuple): "+e,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance("▶","parameter-out-0")}else if("dict"===n.type)if(n.name.startsWith("Literal")){let e=window.prompt("Enter Dict Values (Without {} Brackets):");a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance(e,"out-0")}else{let e=window.prompt("notice","Enter Dict Name (Without Quotes):");a=new b({name:"Hyperparameter (Dict): "+e,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance("▶","parameter-out-0")}else"debug"===n.type?(a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addInPortEnhance("▶","in-0"),a.addInPortEnhance("Data Set","parameter-in-1"),a.addOutPortEnhance("▶","out-0")):"enough"===n.type?(a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addInPortEnhance("▶","in-0"),a.addInPortEnhance("Target Accuracy","parameter-float-in-1"),a.addInPortEnhance("Max Retries","parameter-int-in-2"),a.addInPortEnhance("Metrics","parameter-string-in-3"),a.addOutPortEnhance("▶","out-0"),a.addOutPortEnhance("Should Retrain","out-1")):"literal"===n.type&&(a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addOutPortEnhance("Value","out-0"));else if("ADVANCED"==o.header){a=new b({name:n.name,color:o.color,extras:{type:n.type}}),a.addInPortEnhance("▶","in-0"),a.addOutPortEnhance("▶","out-0");let e={bool:"boolean",str:"string"};o.variables.forEach((t=>{let n=t.name,o=e[t.type]||t.type;switch(t.kind){case"InCompArg":a.addInPortEnhance(`★${n}`,`parameter-${o}-${n}`);break;case"InArg":a.addInPortEnhance(n,`parameter-${o}-${n}`);break;case"OutArg":a.addOutPortEnhance(n,`parameter-out-${o}-${n}`);break;default:console.warn("Unknown variable kind for variable",t)}}))}if(null!=a){let n=t.getDiagramEngine().getRelativeMousePoint(e);a.setPosition(n),t.getDiagramEngine().getModel().addNode(a),a.name.startsWith("Hyperparameter")&&K(!0),V(!1),G(!1),U()}},onDragOver:e=>{e.preventDefault()},onMouseOver:e=>{e.preventDefault()},onMouseUp:e=>{e.preventDefault()},onMouseDown:e=>{e.preventDefault()}},i().createElement(u,null,i().createElement(s.CanvasWidget,{engine:t.getDiagramEngine()})))))};var U,J=n(38423),V=n(99397),q=n(6168),G=n(96486),Q=(n(96315),n(88907)),K=n.n(Q),Y=n(62880),Z=n.n(Y),ee=n(59982),te=(n(54467),n(82067)),ne=n.n(te);!function(e){e.Node=d().div`
		background-color: ${e=>e.background};
		border-radius: 5px;
		font-family: sans-serif;
		color: white;
		border: solid 2px black;
		overflow: visible;
		font-size: 11px;
		border: solid 2px ${e=>e.selected?null==e.borderColor?"rgb(0,192,255)":e.borderColor:"black"};
	`,e.Title=d().div`
		background: rgba(0, 0, 0, 0.3);
		display: flex;
		white-space: nowrap;
		justify-items: center;
	`,e.TitleName=d().div`
		flex-grow: 1;
		padding: 5px 5px;
	`,e.Ports=d().div`
		display: flex;
		background-image: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2));
	`,e.PortsContainer=d().div`
		flex-grow: 1;
		display: flex;
		flex-direction: column;

		&:first-of-type {
			margin-right: 10px;
		}

		&:only-child {
			margin-right: 0px;
		}
	`,e.ImageGalleryContainer=d().div`
		width: 600px;
		height: 440px;
	`}(U||(U={}));class oe extends s.Action{constructor(e={}){e=Object.assign({keyCodes:[46,8]},e),super({type:s.InputType.KEY_DOWN,fire:t=>{if(-1!==e.keyCodes.indexOf(t.event.keyCode)){const e=this.engine.getModel().getSelectedEntities();G.forEach(e,(e=>{if("undefined"!==e.getOptions().name){let t=e.getOptions().name;"Start"!==t&&"Finish"!==t?e.isLocked()?alert(`${t}'s node cannot be deleted!`):e.remove():alert(`${t}'s node cannot be deleted!`)}})),this.engine.repaintCanvas()}}})}}class ie extends o.Component{constructor(){super(...arguments),this.generatePort=e=>o.createElement(g.DefaultPortLabel,{engine:this.props.engine,port:e,key:e.getID()}),this.state={isTooltipActive:!1,nodeDeletable:!1,imageGalleryItems:[{original:"https://picsum.photos/id/1018/1000/600/",thumbnail:"https://picsum.photos/id/1018/250/150/"},{original:"https://picsum.photos/id/1015/1000/600/",thumbnail:"https://picsum.photos/id/1015/250/150/"},{original:"https://picsum.photos/id/1019/1000/600/",thumbnail:"https://picsum.photos/id/1019/250/150/"}]},this.onPageChanged=e=>{console.log(e.currentPage),this.props.node.getOptions().extras.imageGalleryItems}}showTooltip(){this.setState({isTooltipActive:!0})}hideTooltip(){this.setState({isTooltipActive:!1})}handleClose(){delete this.props.engine.getModel().getNodes()[1].getOptions().extras.imageGalleryItems,this.hideTooltip()}handleDeletableNode(e,t){this.setState({[e]:t.target.checked?this.props.node.setLocked(!0):this.props.node.setLocked(!1)})}handleEditLiteral(){if(!this.props.node.getOptions().name.startsWith("Literal"))return;let e=null;var t=this.props.node;let n=window.prompt("Enter New Value (Without Quotes):");e=new b({name:t.name,color:t.color,extras:{type:t.extras.type}}),e.addOutPortEnhance(n,"out-0");let o=this.props.node.getPosition();e.setPosition(o),this.props.engine.getModel().addNode(e),this.props.node.remove()}render(){return null!=this.props.node.getOptions().extras.tip&&""!=this.props.node.getOptions().extras.tip?o.createElement(U.Node,{onMouseEnter:this.showTooltip.bind(this),onMouseLeave:this.hideTooltip.bind(this),ref:e=>{this.element=e},borderColor:this.props.node.getOptions().extras.borderColor,"data-default-node-name":this.props.node.getOptions().name,selected:this.props.node.isSelected(),background:this.props.node.getOptions().color},o.createElement(Z(),{active:this.state.isTooltipActive,position:"top",arrow:"center",parent:this.element},o.createElement("p",null,this.props.node.getOptions().extras.tip)),o.createElement(U.Title,null,o.createElement(U.TitleName,null,this.props.node.getOptions().name),o.createElement("label",null,o.createElement(ne(),{className:"lock",checked:this.props.node.isLocked(),onChange:this.handleDeletableNode.bind(this,"nodeDeletable")}))),o.createElement(U.Ports,null,o.createElement(U.PortsContainer,null,G.map(this.props.node.getInPorts(),this.generatePort)),o.createElement(U.PortsContainer,null,G.map(this.props.node.getOutPorts(),this.generatePort)))):null!=this.props.node.getOptions().extras.imageGalleryItems?o.createElement(U.Node,{onMouseEnter:this.showTooltip.bind(this),onMouseLeave:this.hideTooltip.bind(this),ref:e=>{this.element=e},borderColor:this.props.node.getOptions().extras.borderColor,"data-default-node-name":this.props.node.getOptions().name,selected:this.props.node.isSelected(),background:this.props.node.getOptions().color},o.createElement(Z(),{active:this.state.isTooltipActive,position:"top",arrow:"center",parent:this.element},o.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.handleClose.bind(this)},o.createElement("span",{"aria-hidden":"true"},"×")),o.createElement(U.ImageGalleryContainer,null,o.createElement(K(),{items:this.state.imageGalleryItems})),o.createElement(ee.Pagination,{totalRecords:100,pageLimit:5,pageNeighbours:1,onPageChanged:this.onPageChanged})),o.createElement(U.Title,null,o.createElement(U.TitleName,null,this.props.node.getOptions().name)),o.createElement(U.Ports,null,o.createElement(U.PortsContainer,null,G.map(this.props.node.getInPorts(),this.generatePort)),o.createElement(U.PortsContainer,null,G.map(this.props.node.getOutPorts(),this.generatePort)))):"Start"!==this.props.node.getOptions().name&&"Finish"!==this.props.node.getOptions().name?o.createElement(U.Node,{borderColor:this.props.node.getOptions().extras.borderColor,"data-default-node-name":this.props.node.getOptions().name,selected:this.props.node.isSelected(),background:this.props.node.getOptions().color,onDoubleClick:this.handleEditLiteral.bind(this)},o.createElement(U.Title,null,o.createElement(U.TitleName,null,this.props.node.getOptions().name),o.createElement("label",null,o.createElement(ne(),{className:"lock",checked:this.props.node.isLocked(),onChange:this.handleDeletableNode.bind(this,"nodeDeletable")}))),o.createElement(U.Ports,null,o.createElement(U.PortsContainer,null,G.map(this.props.node.getInPorts(),this.generatePort)),o.createElement(U.PortsContainer,null,G.map(this.props.node.getOutPorts(),this.generatePort)))):o.createElement(U.Node,{borderColor:this.props.node.getOptions().extras.borderColor,"data-default-node-name":this.props.node.getOptions().name,selected:this.props.node.isSelected(),background:this.props.node.getOptions().color},o.createElement(U.Title,null,o.createElement(U.TitleName,null,this.props.node.getOptions().name)),o.createElement(U.Ports,null,o.createElement(U.PortsContainer,null,G.map(this.props.node.getInPorts(),this.generatePort)),o.createElement(U.PortsContainer,null,G.map(this.props.node.getOutPorts(),this.generatePort))))}}class ae extends s.AbstractReactFactory{constructor(){super("custom-node")}generateModel(e){return new b}generateReactWidget(e){return o.createElement(ie,{engine:this.engine,node:e.model})}}class re{constructor(){this.diagramEngine=p()({registerDefaultZoomCanvasAction:!1,registerDefaultDeleteItemsAction:!1}),this.activeModel=new g.DiagramModel,this.diagramEngine.getNodeFactories().registerFactory(new ae),this.diagramEngine.getActionEventBus().registerAction(new s.ZoomCanvasAction({inverseZoom:!0})),this.diagramEngine.getActionEventBus().registerAction(new oe);let e=new b({name:"Start",color:"rgb(255,102,102)",extras:{type:"Start"}});e.addOutPortEnhance("▶","out-0"),e.addOutPortEnhance("  ","parameter-out-1"),e.setPosition(100,100);let t=new b({name:"Finish",color:"rgb(255,102,102)",extras:{type:"Finish"}});t.addInPortEnhance("▶","in-0"),t.addInPortEnhance("  ","parameter-in-1"),t.setPosition(700,100),this.activeModel.addAll(e,t),this.diagramEngine.setModel(this.activeModel)}getActiveDiagram(){return this.activeModel}getDiagramEngine(){return this.diagramEngine}}class se extends m.ReactWidget{constructor(e){super(e),this.app=e.app,this.shell=e.shell,this.commands=e.commands,this.context=e.context,this.serviceManager=e.serviceManager,this.saveXircuitSignal=e.saveXircuitSignal,this.compileXircuitSignal=e.compileXircuitSignal,this.runXircuitSignal=e.runXircuitSignal,this.runTypeXircuitSignal=e.runTypeXircuitSignal,this.debugXircuitSignal=e.debugXircuitSignal,this.lockNodeSignal=e.lockNodeSignal,this.breakpointXircuitSignal=e.breakpointXircuitSignal,this.currentNodeSignal=e.currentNodeSignal,this.testXircuitSignal=e.testXircuitSignal,this.continueDebugSignal=e.continueDebugSignal,this.nextNodeDebugSignal=e.nextNodeDebugSignal,this.stepOverDebugSignal=e.stepOverDebugSignal,this.terminateDebugSignal=e.terminateDebugSignal,this.stepInDebugSignal=e.stepInDebugSignal,this.stepOutDebugSignal=e.stepOutDebugSignal,this.evaluateDebugSignal=e.evaluateDebugSignal,this.debugModeSignal=e.debugModeSignal,this.xircuitsApp=new re}handleEvent(e){if("mouseup"===e.type)this.node.focus();else if("blur"===e.type){const e=e=>e.setSelected(!1),t=this.xircuitsApp.getDiagramEngine().getModel();t.getNodes().forEach(e),t.getLinks().forEach(e)}}onAfterAttach(e){this.node.addEventListener("mouseup",this,!0),this.node.addEventListener("blur",this,!0)}onBeforeDetach(){this.node.removeEventListener("mouseup",this,!0),this.node.removeEventListener("blur",this,!0)}render(){var e;return i().createElement(z,{context:this.context,xircuitsApp:this.xircuitsApp,app:this.app,shell:this.shell,commands:this.commands,widgetId:null===(e=this.parent)||void 0===e?void 0:e.id,serviceManager:this.serviceManager,saveXircuitSignal:this.saveXircuitSignal,compileXircuitSignal:this.compileXircuitSignal,runXircuitSignal:this.runXircuitSignal,runTypeXircuitSignal:this.runTypeXircuitSignal,debugXircuitSignal:this.debugXircuitSignal,lockNodeSignal:this.lockNodeSignal,breakpointXircuitSignal:this.breakpointXircuitSignal,currentNodeSignal:this.currentNodeSignal,testXircuitSignal:this.testXircuitSignal,continueDebugSignal:this.continueDebugSignal,nextNodeDebugSignal:this.nextNodeDebugSignal,stepOverDebugSignal:this.stepOverDebugSignal,terminateDebugSignal:this.terminateDebugSignal,stepInDebugSignal:this.stepInDebugSignal,stepOutDebugSignal:this.stepOutDebugSignal,evaluateDebugSignal:this.evaluateDebugSignal,debugModeSignal:this.debugModeSignal})}}class le extends m.ReactWidget{constructor(e){super(),this.handleChange=e=>{let t=e.target.value;this._output.runTypeXircuitSignal.emit({runType:t}),this.update()},this._output=e}render(){return i().createElement(m.UseSignal,{signal:this._output.runTypeXircuitSignal},((e,t)=>{if(void 0!==t){let e=t.runType;return i().createElement(f.HTMLSelect,{onChange:this.handleChange,value:e,"aria-label":"Run type",title:"Select the run type"},i().createElement("option",{value:"run"},"Run"),i().createElement("option",{value:"run-dont-compile"},"Run w/o Compile"),i().createElement("option",{value:"spark-submit"},"Spark Submit"))}return i().createElement(f.HTMLSelect,{onChange:this.handleChange,value:void 0,"aria-label":"Run type",title:"Select the run type"},i().createElement("option",{value:"run"},"Run"),i().createElement("option",{value:"run-dont-compile"},"Run w/o Compile"),i().createElement("option",{value:"spark-submit"},"Spark Submit"))}))}}class de extends V.ABCWidgetFactory{constructor(e){super(e),this.app=e.app,this.shell=e.shell,this.commands=e.commands,this.serviceManager=e.serviceManager,this.saveXircuitSignal=new q.Signal(this),this.compileXircuitSignal=new q.Signal(this),this.runXircuitSignal=new q.Signal(this),this.runTypeXircuitSignal=new q.Signal(this),this.debugXircuitSignal=new q.Signal(this),this.lockNodeSignal=new q.Signal(this),this.breakpointXircuitSignal=new q.Signal(this),this.currentNodeSignal=new q.Signal(this),this.testXircuitSignal=new q.Signal(this),this.continueDebugSignal=new q.Signal(this),this.nextNodeDebugSignal=new q.Signal(this),this.stepOverDebugSignal=new q.Signal(this),this.terminateDebugSignal=new q.Signal(this),this.stepInDebugSignal=new q.Signal(this),this.stepOutDebugSignal=new q.Signal(this),this.evaluateDebugSignal=new q.Signal(this),this.debugModeSignal=new q.Signal(this)}createNewWidget(e){const t={app:this.app,shell:this.shell,commands:this.commands,context:e,serviceManager:this.serviceManager,saveXircuitSignal:this.saveXircuitSignal,compileXircuitSignal:this.compileXircuitSignal,runXircuitSignal:this.runXircuitSignal,runTypeXircuitSignal:this.runTypeXircuitSignal,debugXircuitSignal:this.debugXircuitSignal,lockNodeSignal:this.lockNodeSignal,breakpointXircuitSignal:this.breakpointXircuitSignal,currentNodeSignal:this.currentNodeSignal,testXircuitSignal:this.testXircuitSignal,continueDebugSignal:this.continueDebugSignal,nextNodeDebugSignal:this.nextNodeDebugSignal,stepOverDebugSignal:this.stepOverDebugSignal,terminateDebugSignal:this.terminateDebugSignal,stepInDebugSignal:this.stepInDebugSignal,stepOutDebugSignal:this.stepOutDebugSignal,evaluateDebugSignal:this.evaluateDebugSignal,debugModeSignal:this.debugModeSignal},n=new se(t),o=new V.DocumentWidget({content:n,context:e});o.addClass("xircuits-editor"),o.title.iconClass="jp-XircuitLogo";let i=new m.ToolbarButton({icon:f.saveIcon,tooltip:"Save Xircuits",onClick:()=>{this.commands.execute(H.saveXircuit)}}),a=new m.ToolbarButton({icon:f.refreshIcon,tooltip:"Reload Xircuits from Disk",onClick:()=>{this.commands.execute(H.reloadDocManager)}}),r=new m.ToolbarButton({icon:f.undoIcon,tooltip:"Revert Xircuits to Checkpoint",onClick:()=>{this.commands.execute(H.revertDocManager)}}),s=new m.ToolbarButton({icon:f.checkIcon,tooltip:"Compile Xircuits",onClick:()=>{this.commands.execute(H.compileXircuit)}}),l=new m.ToolbarButton({icon:f.runIcon,tooltip:"Run Xircuits",onClick:()=>{this.commands.execute(H.runXircuit)}}),d=new m.ToolbarButton({icon:f.bugIcon,tooltip:"Open Xircuits Debugger and enable Image Viewer",onClick:()=>{this.commands.execute(H.debugXircuit)}}),c=new m.ToolbarButton({icon:f.listIcon,tooltip:"Open log",onClick:()=>{this.commands.execute(v.openLog)}}),u=new m.ToolbarButton({iconClass:"jp-LockLogo",tooltip:"Lock all non-general nodes connected from start node",onClick:()=>{this.commands.execute(H.lockXircuit)}}),g=new m.ToolbarButton({icon:f.editIcon,tooltip:"For testing purpose",onClick:()=>{this.commands.execute(H.testXircuit)}});return o.toolbar.insertItem(0,"xircuits-add-save",i),o.toolbar.insertItem(1,"xircuits-add-reload",a),o.toolbar.insertItem(2,"xircuits-add-revert",r),o.toolbar.insertItem(3,"xircuits-add-compile",s),o.toolbar.insertItem(4,"xircuits-add-run",l),o.toolbar.insertItem(5,"xircuits-add-debug",d),o.toolbar.insertItem(6,"xircuits-add-lock",u),o.toolbar.insertItem(7,"xircuits-add-log",c),o.toolbar.insertItem(8,"xircuits-add-test",g),o.toolbar.insertItem(9,"xircuits-run-type",new le(this)),o}}const ce=d().div`
	color: black;
	font-family: Helvetica, Arial;
	padding: 7px;
	width: auto;
	margin: 7px;
	border: solid 1px ${e=>e.color};
	border-radius: 5px;
	margin-bottom: 2px;
	cursor: pointer;
`;class ue extends o.Component{render(){return o.createElement(ce,{color:this.props.color||"white",draggable:!0,onDragStart:e=>{e.dataTransfer.setData("storm-diagram-node",JSON.stringify(this.props.model)),this.forceUpdate()},onClick:e=>{if(e.ctrlKey||e.metaKey){const{commands:e}=this.props.app;e.execute("docmanager:open",{path:this.props.path,factory:"Editor"})}this.forceUpdate()},onDoubleClick:e=>{if(""!=this.props.path){const{commands:e}=this.props.app;e.execute("docmanager:open",{path:this.props.path,factory:"Editor"})}this.forceUpdate()},className:"tray-item"},this.props.name)}}const ge=d().div`
	min-width: 150px;
	background: rgb(255, 255, 255);
	flex-grow: 1;
	width: 150px;
	flex-shrink: 1;
	max-height: auto;
	overflow-y: auto;
`;class pe extends o.Component{render(){return o.createElement(ge,null,this.props.children)}}var me=n(76435);const he=d().div`
  flex-grow: 1;
  display: flex;
  flex-wrap: wrap;
  min-height: 100%;
  background-color: black;
  height: 100%;
  overflow-y: auto;
`,be=d().div`
    display: flex;
    flex-grow: 1;
    flex-wrap: wrap;
    max-height: auto;
    'border-top': '4px solid #dfe2e5'
`;function fe(e){const[t,n]=i().useState([]),[a,r]=i().useState([]),[s,l]=(0,o.useState)(""),[d,c]=(0,o.useState)(!1),u=async()=>{const t=await N(e.lab.serviceManager),o=await async function(e){let t=e.map((e=>e.category)),n=Array.from(new Set(t)),o=[],i=[],a=[];for(let e=0;e<n.length;e++)"ADVANCED"==n[e]||"GENERAL"==n[e]?o.push(n[e]):i.push(n[e]);if(0!=o.length){o=o.sort(((e,t)=>e<t?1:e>t?-1:0)),n=[...o,...i];for(let e=0;e<n.length;e++)a.push({task:n[e],id:e+1})}return a}(t);t.length>0&&(n([]),r([])),n(t),r(o)};return(0,o.useEffect)((()=>{d||(u(),c(!0))}),[a,t]),(0,o.useEffect)((()=>{const e=setInterval((()=>{u()}),6e5);return()=>clearInterval(e)}),[a,t]),i().createElement(he,null,i().createElement(be,null,i().createElement(pe,null,i().createElement("div",null,i().createElement("div",{className:"search-input"},i().createElement("input",{type:"text",name:"",value:s,placeholder:"SEARCH",className:"search-input__text-input",style:{width:"80%"},onChange:e=>{l(""),l(e.target.value)}}),i().createElement("a",{onClick:function(){l(""),l(s)},className:"search-input__button"},i().createElement("i",{className:"fa fa-search "})),i().createElement("a",{onClick:function(){u()},className:"search-input__button"},i().createElement("i",{className:"fa fa-refresh "}))),i().createElement(me.Accordion,{allowZeroExpanded:!0},a.filter((e=>{if(""==s)return e})).map(((n,o)=>i().createElement(me.AccordionItem,{key:`index-1-${n.task.toString()}`},i().createElement(me.AccordionItemHeading,null,i().createElement(me.AccordionItemButton,null,n.task)),i().createElement(me.AccordionItemPanel,null,t.filter((e=>{if(""==s)return e})).map(((t,o)=>{if(t.category.toString().toUpperCase()==n.task.toString())return i().createElement("div",{key:`index-1-${o}`},i().createElement(ue,{model:{type:t.type,name:t.task},name:t.task,color:t.color,app:e.lab,path:t.path}))}))))))),t.filter((e=>{if(""!=s&&e.task.toLowerCase().includes(s.toLowerCase()))return e})).map(((t,n)=>i().createElement("div",{key:`index-3-${n}`},i().createElement(ue,{model:{type:t.type,name:t.task},name:t.task,color:t.color,app:e.lab,path:t.path}))))))))}var xe=n(25003),Se=n(78062),ve=n(80861);const ye=({xircuitFactory:e,currentNode:t})=>{const[n,a]=(0,o.useState)(""),[r,s]=(0,o.useState)(""),[l,d]=(0,o.useState)(""),[c,u]=(0,o.useState)([]),[g,p]=(0,o.useState)([]),m=(0,o.useRef)(!1);return(0,o.useEffect)((()=>{m.current?(()=>{let e=void 0===t.item?"":t.item,n=void 0===t.item2?"":t.item2,o=e.getOptions().name,i=e.getOptions().id,r=e.getOptions().extras.type,l=[],c=[],g=[],m=n;if("string"!=typeof n&&(m=n.output),""!=m)if(m.includes("InArg ->")&&m.includes("OutArg ->")){let e=m.split("OutArg -> "),t=e[0].split("InArg -> ");for(let e=0;e<t[1].split("\t").length;e++)l.push(t[1].split("\t")[e]);for(let t=0;t<e[1].split("\t").length;t++)e[1].split("\t")[t].includes(": None")||l.push(e[1].split("\t")[t])}else if(m.includes("InArg ->")&&!m.includes("OutArg ->"))for(let e=0;e<m.split("InArg -> ")[1].split("\t").length;e++)l.push(m.split("InArg -> ")[1].split("\t")[e]);else if(!m.includes("InArg ->")&&m.includes("OutArg ->"))for(let e=0;e<m.split("OutArg -> ")[1].split("\t").length;e++)m.split("OutArg -> ")[1].split("\t")[e].includes(": None")||l.push(m.split("OutArg -> ")[1].split("\t")[e]);e.portsIn.forEach((e=>{"▶"!=e.getOptions().label&&c.push(e.getOptions().label)})),e.portsOut.forEach((e=>{"▶"!=e.getOptions().label&&g.push(e.getOptions().label)})),function(e,t,n,o,i){a(e),s(t),d(n),u(o),p(i)}(o,i,r,l,g)})():m.current=!0}),[t]),i().createElement("div",{style:{minHeight:"800px",height:"100%",width:"100%",minWidth:"150px",flexGrow:1,flexShrink:1,margin:"7px",padding:"7px",fontSize:"14px"}},i().createElement("p",null,i().createElement("b",null,"Selected Node")),i().createElement("p",null,i().createElement("b",null,"Name:")," ",n),i().createElement("p",null,i().createElement("b",null,"Id:")," ",r),i().createElement("p",null,i().createElement("b",null,"Type:")," ",l),i().createElement("p",null,i().createElement("b",null,"PortInLabel:")," ",c.map(((e,t)=>i().createElement("p",{key:t},e.split("\n").map(((e,t)=>i().createElement("p",{key:t},e))))))),i().createElement("p",null,i().createElement("b",null,"PortOutLabel:")," ",g.map(((e,t)=>i().createElement("p",{key:t},e)))))};class we extends m.ReactWidget{constructor(e){super(),this._xircuitFactory=e,this.addClass("jp-DebuggerWidget")}render(){return i().createElement(m.UseSignal,{signal:this._xircuitFactory.currentNodeSignal},((e,t)=>i().createElement(ye,{xircuitFactory:this._xircuitFactory,currentNode:t})))}}const Ee="Xircuits-debugger:continue",Oe="Xircuits-debugger:terminate",ke="Xircuits-debugger:next";class Ce extends D.Panel{constructor(e){super();const t=e.translator||Se.nullTranslator,n=e.app,o=e.widgetFactory,i=t.load("jupyterlab");this.id="jp-debugger-sidebar",this.addClass("jp-DebuggerSidebar"),this._body=new D.SplitPanel,this._body.orientation="vertical",this.addWidget(this._body);const a=new we(o),r=new _e(t),s=new Ne;let l,d;o.debugModeSignal.connect(((e,t)=>{l=t.debugMode,d=t.inDebugMode,n.commands.notifyCommandChanged()})),s.toolbar.addItem("xircuits-debugger-continue",new m.CommandToolbarButton({commands:n.commands,id:Ee})),s.toolbar.addItem("xircuits-debugger-next",new m.CommandToolbarButton({commands:n.commands,id:H.nextNode})),s.toolbar.addItem("xircuits-debugger-step-over",new m.CommandToolbarButton({commands:n.commands,id:ke})),s.toolbar.addItem("xircuits-debugger-breakpoint",new m.CommandToolbarButton({commands:n.commands,id:H.breakpointXircuit})),s.toolbar.addItem("xircuits-debugger-terminate",new m.CommandToolbarButton({commands:n.commands,id:Oe})),s.toolbar.addItem("xircuits-debugger-step-in",new m.CommandToolbarButton({commands:n.commands,id:"Xircuits-debugger:step-in"})),s.toolbar.addItem("xircuits-debugger-step-out",new m.CommandToolbarButton({commands:n.commands,id:"Xircuits-debugger:step-out"})),s.toolbar.addItem("xircuits-debugger-evaluate-code",new m.CommandToolbarButton({commands:n.commands,id:"Xircuits-debugger:evaluate-code"})),n.commands.addCommand(Ee,{caption:i.__("Continue"),icon:ve.Debugger.Icons.continueIcon,isEnabled:()=>null!=l&&l,execute:e=>{o.continueDebugSignal.emit(e)}}),n.commands.addCommand(H.nextNode,{caption:i.__("Next Node"),iconClass:"jp-NextLogo",isEnabled:()=>null!=d&&d,execute:e=>{o.nextNodeDebugSignal.emit(e)}}),n.commands.addCommand(ke,{caption:i.__("Step Over"),icon:ve.Debugger.Icons.stepOverIcon,isEnabled:()=>null!=d&&d,execute:e=>{o.stepOverDebugSignal.emit(e)}}),n.commands.addCommand(H.breakpointXircuit,{caption:i.__("Toggle Breakpoint"),iconClass:"jp-BreakpointLogo",isEnabled:()=>null!=l&&l,execute:e=>{o.breakpointXircuitSignal.emit(e)}}),n.commands.addCommand(Oe,{caption:i.__("Terminate"),icon:ve.Debugger.Icons.terminateIcon,isEnabled:()=>null!=l&&l,execute:e=>{o.terminateDebugSignal.emit(e)}}),this.addWidget(r),this.addWidget(s),this.addWidget(a),this.addClass("jp-DebuggerBreakpoints")}addItem(e){this._body.addWidget(e)}insertItem(e,t){this._body.insertWidget(e,t)}get items(){return this._body.widgets}dispose(){this.isDisposed||super.dispose()}}class _e extends D.Widget{constructor(e){super({node:document.createElement("div")}),this.node.classList.add("jp-stack-panel-header");const t=(e=e||Se.nullTranslator).load("jupyterlab"),n=new D.Widget({node:document.createElement("h2")});n.node.textContent=t.__("Xircuits Debugger");const o=new D.PanelLayout;o.addWidget(n),this.layout=o}}class Ne extends D.Widget{constructor(){super({node:document.createElement("div")}),this.toolbar=new m.Toolbar,this.node.classList.add("jp-debugger-toolbar-panel");const e=new D.PanelLayout;e.addWidget(this.toolbar),this.layout=e}}var Pe;!function(e){e.Sidebar=class extends Ce{}}(Pe||(Pe={}));var De=n(28054);class Ie extends D.StackedPanel{constructor(e,t,n,o){super(),this._translator=o||Se.nullTranslator,this._trans=this._translator.load("jupyterlab"),this._xircuitFactory=n,this.addClass("jp-RovaPanel"),this.id="xircuit-output-panel",this.title.label=this._trans.__("Xircuit Output"),this.title.closable=!0,this.title.iconClass="jp-XircuitLogo",this._sessionContext=new m.SessionContext({sessionManager:e.sessions,specsManager:e.kernelspecs,name:"Xircuit Output Process"}),this._outputareamodel=new De.OutputAreaModel,this._outputarea=new De.SimplifiedOutputArea({model:this._outputareamodel,rendermime:t}),this.addWidget(this._outputarea),this._sessionContext.initialize().then((async e=>{e&&await m.sessionContextDialogs.selectKernel(this._sessionContext)})).catch((e=>{console.error(`Failed to initialize the session in Xircuit Output.\n${e}`)}))}get session(){return this._sessionContext}dispose(){this._sessionContext.sessionManager.shutdown(this._sessionContext.session.id),this._sessionContext.dispose(),this._xircuitFactory.terminateDebugSignal.emit(this),this._sessionContext.sessionManager.refreshRunning(),super.dispose()}execute(e,t){De.SimplifiedOutputArea.execute(e,this._outputarea,this._sessionContext).then((e=>{if(this._outputarea.model.toJSON().length>0)for(let e=0;e<this._outputarea.model.toJSON().length;e++){if("error"==this._outputarea.model.toJSON()[e].output_type){let n=this._outputarea.model.toJSON()[e].ename,o=this._outputarea.model.toJSON()[e].evalue,i=this._outputarea.model.toJSON()[e].traceback;if(o.includes("File")&&o.includes("not found"))return alert(n+": "+o+" Please compile first!"),t.error(n+": "+o),void console.log(o+" Please compile first!");for(let e of i)t.error(e);return}let n=this._outputarea.model.toJSON()[e].text;for(let e=0;e<n.split("\n").length;e++)""!=n.split("\n")[e].trim()&&t.info(n.split("\n")[e])}})).catch((e=>console.error(e)))}onCloseRequest(e){super.onCloseRequest(e),this.dispose()}}const Le="Xircuits editor",Xe=[{id:"xircuits",autoStart:!0,requires:[J.ILauncher,r.IFileBrowserFactory,a.ILayoutRestorer,y.IRenderMimeRegistry,xe.IDocumentManager,Se.ITranslator],activate:async(e,t,n,o,a,r,s)=>{console.log("Xircuits is activated!");const l=new de({name:Le,fileTypes:["xircuits"],defaultFor:["xircuits"],app:e,shell:e.shell,commands:e.commands,serviceManager:e.serviceManager});e.docRegistry.addFileType({name:"xircuits",displayName:"Xircuits",extensions:[".xircuits"],iconClass:"jp-XircuitLogo"}),e.docRegistry.addWidgetFactory(l);const d=new m.WidgetTracker({namespace:"Xircuits Tracker"});l.widgetCreated.connect(((e,t)=>{d.add(t),t.context.pathChanged.connect((()=>{d.save(t)}))})),o.restore(d,{command:H.openDocManager,args:e=>({path:e.context.path,factory:Le}),name:e=>e.context.path});const c=m.ReactWidget.create(i().createElement(fe,{lab:e}));c.id="xircuits-component-sidebar",c.title.iconClass="jp-ComponentLibraryLogo",c.title.caption="Xircuits Component Library",o.add(c,c.id),e.shell.add(c,"left");const u=new Pe.Sidebar({app:e,translator:s,widgetFactory:l});let g;u.id="xircuits-debugger-sidebar",u.title.iconClass="jp-DebuggerLogo",u.title.caption="Xircuits Debugger",o.add(u,u.id),e.shell.add(u,"right",{rank:1001}),e.commands.addCommand(H.openDebugger,{execute:()=>{u.isHidden&&e.shell.activateById(u.id)}}),e.commands.addCommand(H.createNewXircuit,{label:"Xircuits File",iconClass:"jp-XircuitLogo",caption:"Create a new xircuits file",execute:()=>{e.commands.execute(H.newDocManager,{path:n.defaultBrowser.model.path,type:"file",ext:".xircuits"}).then((async t=>{(await e.commands.execute(H.openDocManager,{path:t.path,factory:Le})).context.ready.then((()=>{e.commands.execute(H.saveXircuit,{path:t.path})}))}))}}),e.commands.addCommand(H.createArbitraryFile,{execute:async t=>{const n=d.currentWidget.context.path,o=n,i=void 0===typeof t.pythonCode?"":t.pythonCode,a=void 0!==typeof t.showOutput&&t.showOutput,s=await async function(e,t){const n={currentPath:e.split(".xircuits")[0]+".py",compilePythonScript:t};try{return await _("file/generate",{body:JSON.stringify(n),method:"POST"})}catch(e){console.error(`Error on POST /xircuits/file/generate ${n}.\n${e}`)}}(o,i);if("completed"==s.message){const t=n.split(".xircuits")[0]+".py";await e.commands.execute(H.openDocManager,{path:t}),r.closeFile(t),a&&alert(`${t} successfully compiled!`)}else alert("Failed to generate arbitrary file!")}}),e.commands.addCommand(H.executeToOutputPanel,{execute:async t=>{const n=new O(e),o=d.currentWidget.context.path.split(".xircuits")[0]+".py",i=void 0===t.runCommand?"":t.runCommand,r=void 0===t.debug_mode?"":t.debug_mode,c=void 0===t.runType?"":t.runType,u=void 0===t.addArgsSparkSubmit?"":t.addArgsSparkSubmit;!g||g.isDisposed||g.dispose(),await async function(){return g=new Ie(e.serviceManager,a,l,s),e.shell.add(g,"main",{mode:"split-bottom"}),g}(),g.session.ready.then((async()=>{let e="%run "+o+i+r;if("spark-submit"==c){const t=await async function(e,t){const n={currentPath:e,addArgs:t};try{return await _("spark/submit",{body:JSON.stringify(n),method:"POST"})}catch(e){console.error(`Error on POST /xircuits/spark/submit ${n}.\n${e}`)}}(o,u),n=t.stderr,i=t.stdout;let a="";a=0!=i?i:n,e=`print("""${a}""")`}g.execute(e,n)}))}}),e.commands.addCommand(H.saveXircuit,{execute:e=>{l.saveXircuitSignal.emit(e)}}),e.commands.addCommand(H.compileXircuit,{execute:e=>{l.compileXircuitSignal.emit(e)}}),e.commands.addCommand(H.runXircuit,{execute:e=>{l.runXircuitSignal.emit(e)}}),e.commands.addCommand(H.debugXircuit,{execute:e=>{l.debugXircuitSignal.emit(e)}}),e.commands.addCommand(H.lockXircuit,{execute:e=>{l.lockNodeSignal.emit(e)}}),e.commands.addCommand(H.testXircuit,{execute:e=>{l.testXircuitSignal.emit(e)}}),t&&t.add({command:H.createNewXircuit,rank:1,category:"Other"})}},E]}}]);