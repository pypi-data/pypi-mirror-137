{"version":3,"sources":["pagesView.es6.js"],"names":[],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,CAAC,MAAR,CAAe,SAAf,GAA2B,QAAQ,CAAC,IAAT,CAAc,MAAd,CAAqB;AAC5C;AACJ;AACA;AACA;AACA;AACI,EAAA,UAN4C,wBAM/B;AACT,SAAK,MAAL,GAAc,IAAI,QAAQ,CAAC,MAAb,CAAoB;AAC9B,MAAA,MAAM,EAAE;AACJ,mBAAW;AADP;AADsB,KAApB,CAAd;AAKA,SAAK,QAAL,CAAc,KAAK,MAAnB,EAA2B,YAA3B,EAAyC,KAAK,cAA9C;AAEA,SAAK,WAAL,GAAmB,IAAnB;AACA,SAAK,YAAL,GAAoB,IAApB;AACA,SAAK,iBAAL,GAAyB,IAAzB;AACH,GAjB2C;;AAmB5C;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACI,EAAA,MA7B4C,oBA6BnC;AACL,SAAK,UAAL,GAAkB,KAAK,CAAL,CAAO,wCAAP,CAAlB;AACA,SAAK,OAAL,GAAe,KAAK,CAAL,CAAO,iCAAP,CAAf;AAEA,SAAK,WAAL,GAAmB,KAAK,UAAL,CAAgB,EAAhB,CAAmB,CAAnB,EAAsB,QAAtB,CAA+B,YAA/B,CAAnB;AACA,SAAK,YAAL,GAAoB,KAAK,OAAL,CAAa,EAAb,CAAgB,CAAhB,EAAmB,QAAnB,CAA4B,YAA5B,CAApB;AAEA,IAAA,QAAQ,CAAC,OAAT,CAAiB,KAAjB,CAAuB;AACnB,MAAA,IAAI,EAAE,MAAM,CAAC,QAAP,CAAgB;AADH,KAAvB;AAIA,WAAO,IAAP;AACH,GAzC2C;;AA2C5C;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACI,EAAA,cAzD4C,0BAyD7B,MAzD6B,EAyDrB;AACnB,SAAK,WAAL,CAAiB,WAAjB,CAA6B,YAA7B;;AACA,SAAK,YAAL,CAAkB,WAAlB,CAA8B,YAA9B;;AAEA,SAAK,YAAL,GAAoB,CAAC,iBAAU,MAAV,EAArB;;AAEA,QAAI,KAAK,YAAL,CAAkB,MAAlB,KAA6B,CAAjC,EAAoC;AAChC;AACZ;AACA;AACA;AACY,WAAK,MAAL,CAAY,QAAZ,CACI,KAAK,UAAL,CAAgB,IAAhB,CAAqB,GAArB,EAA0B,IAA1B,CAA+B,MAA/B,EAAuC,MAAvC,CAA8C,CAA9C,CADJ,EAEI;AACI,QAAA,OAAO,EAAE,IADb;AAEI,QAAA,OAAO,EAAE;AAFb,OAFJ;AAMH,KAXD,MAWO;AACH,WAAK,WAAL,GACI,KAAK,UAAL,CACK,MADL,0BAC6B,MAD7B,WAEK,QAFL,CAEc,YAFd,CADJ;;AAKA,WAAK,YAAL,CAAkB,QAAlB,CAA2B,YAA3B;;AAEA,UAAI,CAAC,KAAK,iBAAV,EAA6B;AACzB,QAAA,CAAC,CAAC,WAAD,CAAD,CAAe,MAAf;AACH;;AAED,WAAK,iBAAL,GAAyB,KAAzB;AACH;AACJ;AAxF2C,CAArB,CAA3B","file":"pagesView.js","sourcesContent":["/**\n * Manages a collection of configuration pages.\n *\n * The primary job of this view is to handle sub-page navigation.\n * The actual page will contain several \"pages\" that are shown or hidden\n * depending on what the user has clicked on the sidebar.\n */\nDjblets.Config.PagesView = Backbone.View.extend({\n    /**\n     * Initialize the view.\n     *\n     * This will set up the router for handling page navigation.\n     */\n    initialize() {\n        this.router = new Backbone.Router({\n            routes: {\n                ':pageID': 'page'\n            }\n        });\n        this.listenTo(this.router, 'route:page', this._onPageChanged);\n\n        this._$activeNav = null;\n        this._$activePage = null;\n        this._preserveMessages = true;\n    },\n\n    /**\n     * Render the view.\n     *\n     * This will set the default page to be shown, and instruct Backbone\n     * to begin handling the routing.\n     *\n     * Returns:\n     *     Djblets.Config.PageView:\n     *     This view.\n     */\n    render() {\n        this._$pageNavs = this.$('.djblets-c-config-forms-page-nav__item');\n        this._$pages = this.$('.djblets-c-config-forms-subpage');\n\n        this._$activeNav = this._$pageNavs.eq(0).addClass('-is-active');\n        this._$activePage = this._$pages.eq(0).addClass('-is-active');\n\n        Backbone.history.start({\n            root: window.location.pathname,\n        });\n\n        return this;\n    },\n\n    /**\n     * Handle when the page changes.\n     *\n     * The sidebar will be updated to reflect the current active page,\n     * and the page will be shown.\n     *\n     * If navigating pages manually, any messages provided by the backend\n     * form will be removed. We don't do this the first time there's a\n     * navigation, as this will be called when first rendering the view.\n     *\n     * Args:\n     *     pageID (string):\n     *         The ID of the page that is becoming active.\n     */\n    _onPageChanged(pageID) {\n        this._$activeNav.removeClass('-is-active');\n        this._$activePage.removeClass('-is-active');\n\n        this._$activePage = $(`#page_${pageID}`);\n\n        if (this._$activePage.length === 0) {\n            /*\n             * If the requested page doesn't exist (for example, it might be\n             * hidden, or just typoed), load the first page instead.\n             */\n            this.router.navigate(\n                this._$pageNavs.find('a').attr('href').substr(1),\n                {\n                    trigger: true,\n                    replace: true\n                });\n        } else {\n            this._$activeNav =\n                this._$pageNavs\n                    .filter(`:has(a[href=\"#${pageID}\"])`)\n                    .addClass('-is-active');\n\n            this._$activePage.addClass('-is-active');\n\n            if (!this._preserveMessages) {\n                $('#messages').remove();\n            }\n\n            this._preserveMessages = false;\n        }\n    },\n});\n"]}