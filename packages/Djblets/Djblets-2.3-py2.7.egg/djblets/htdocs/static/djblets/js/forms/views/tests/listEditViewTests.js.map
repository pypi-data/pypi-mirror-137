{"version":3,"sources":["listEditViewTests.es6.js"],"names":[],"mappings":"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","file":"listEditViewTests.js","sourcesContent":["suite('djblets/forms/views/ListEditView', function() {\n    /*\n     * See templates/djblets_forms/list_edit_widget.html.\n     */\n    const formTemplate = _.template(dedent`\n        <div class=\"djblets-c-list-edit-widget\">\n         <ul class=\"djblets-c-list-edit-widget__entries\">\n          <% if (items.length > 0) { %>\n           <% items.forEach(function(item, i) { %>\n            <li class=\"djblets-c-list-edit-widget__entry\"\n                data-list-index=\"<%- i %>\">\n             <input value=\"<%- item %>\" type=\"text\"<%= attrs %>>\n             <a href=\"#\" class=\"djblets-c-list-edit-widget__remove-item\"></a>\n            </li>\n           <% }); %>\n          <% } else { %>\n           <li class=\"djblets-c-list-edit-widget__entry\" data-list-index=\"0\">\n            <input type=\"text\">\n            <a href=\"#\" class=\"djblets-c-list-edit-widget__remove-item\"></a>\n           </li>\n          <% } %>\n         </ul>\n         <button class=\"djblets-c-list-edit-widget__add-item\"></button>\n         <input class=\"djblets-c-list-edit-widget__value\"\n                type=\"hidden\" value=\"<%- nonZeroItems.join(',') %>\">\n        </div>\n    `);\n\n    const makeView = function makeView(items=[], attrs='') {\n        attrs = attrs.length ? ` ${attrs}` : '';\n        attrs = `${attrs} class=\"djblets-c-list-edit-widget__input\"`;\n\n        const $el =\n            $(formTemplate({\n                items: items,\n                nonZeroItems: items.filter(i => (i.length > 0)),\n                attrs: attrs,\n            }))\n            .appendTo($testsScratch);\n\n        const view = new Djblets.Forms.ListEditView({\n            el: $el,\n            inputAttrs: attrs,\n            sep: ',',\n        });\n\n        view.render();\n\n        return [view, view.$('.djblets-c-list-edit-widget__value')];\n    };\n\n    describe('Updating fields', function() {\n        it('With no values', function() {\n            const [, $valueField] = makeView([]);\n            expect($valueField.val()).toEqual('');\n        });\n\n        it('With one value', function() {\n            const [view, $valueField] = makeView(['One']);\n\n            expect($valueField.val()).toEqual('One');\n\n            view.$('.djblets-c-list-edit-widget__input').val('Foo').blur();\n            expect($valueField.val()).toEqual('Foo');\n        });\n\n        it('With multiple values', function() {\n            const [view, $valueField] = makeView(['one', 'two', 'three']);\n            const $inputs = view.$('.djblets-c-list-edit-widget__input');\n\n            expect($valueField.val()).toEqual('one,two,three');\n\n            $inputs.eq(2).val('baz').blur();\n            expect($valueField.val()).toEqual('one,two,baz');\n\n            $inputs.eq(0).val('').blur();\n            expect($valueField.val()).toEqual('two,baz');\n\n            $inputs.eq(1).val('').blur();\n            expect($valueField.val()).toEqual('baz');\n\n            $inputs.eq(2).val('').blur();\n            expect($valueField.val()).toEqual('');\n        });\n    });\n\n    describe('Removal', function() {\n        it('With no values', function() {\n            const [view, $valueField] = makeView([]);\n\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(1);\n\n            view.$('.djblets-c-list-edit-widget__remove-item').click();\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(1);\n        });\n\n        it ('With one value', function() {\n            const [view, $valueField] = makeView(['One']);\n            expect($valueField.val()).toEqual('One');\n\n            view.$('.djblets-c-list-edit-widget__remove-item').click();\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(1);\n        });\n\n        it('With multiple values', function() {\n            const [view, $valueField] = makeView(['One', 'Two', 'Three']);\n\n            expect($valueField.val()).toEqual('One,Two,Three');\n\n            expect(view.$('.djblets-c-list-edit-widget__remove-item').length)\n                .toEqual(3);\n\n            view.$('.djblets-c-list-edit-widget__remove-item').eq(1).click();\n            expect($valueField.val()).toEqual('One,Three');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(2);\n            expect(view.$('.djblets-c-list-edit-widget__remove-item').length)\n                .toEqual(2);\n\n            view.$('.djblets-c-list-edit-widget__remove-item').eq(1).click();\n            expect($valueField.val()).toEqual('One');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(1);\n            expect(view.$('.djblets-c-list-edit-widget__remove-item').length)\n                .toEqual(1);\n\n            view.$('.djblets-c-list-edit-widget__remove-item').click();\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(1);\n        });\n    });\n\n    describe('Addition', function() {\n        it('With values', function() {\n            const [view, $valueField] = makeView(['one', 'two', 'three']);\n            expect($valueField.val()).toEqual('one,two,three');\n\n            view.$('.djblets-c-list-edit-widget__add-item').click();\n            expect($valueField.val()).toEqual('one,two,three');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(4);\n\n            view.$('.djblets-c-list-edit-widget__input').eq(3)\n                .val('four')\n                .blur();\n            expect($valueField.val()).toEqual('one,two,three,four');\n        });\n\n        it('With blank values', function() {\n            const [view, $valueField] = makeView(['', '', '']);\n            expect($valueField.val()).toEqual('');\n\n            view.$('.djblets-c-list-edit-widget__add-item').click();\n            expect($valueField.val()).toEqual('');\n            expect(view.$('.djblets-c-list-edit-widget__entry').length)\n                .toEqual(4);\n\n            view.$('.djblets-c-list-edit-widget__input').eq(3)\n                .val('four')\n                .blur();\n            expect($valueField.val()).toEqual('four');\n        });\n\n        it('With correct attributes', function() {\n            const [view,] = makeView([], 'size=\"100\" readonly');\n\n            view.$('.djblets-c-list-edit-widget__add-item').click();\n            const $input = view.$('input').eq(1);\n            expect($input.attr('size')).toEqual('100');\n            expect($input.prop('readonly')).toBe(true);\n        });\n    });\n});\n"]}